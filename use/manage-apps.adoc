---
sidebar: sidebar 
permalink: use/manage-apps.html 
keywords: manage app, discover app, ignore app 
summary: 'Kubernetes クラスタを Astra Control に追加したら、そのクラスタ（ Astra Control の外部）にアプリをインストールし、 Astra Control の [ アプリ ] ページに移動してアプリの管理を開始できます。' 
---
= アプリの管理を開始します
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/use/


お先にどうぞ link:../get-started/add-first-cluster.html["Kubernetes クラスタを Astra Control に追加"]では、クラスターにアプリケーションをインストールし（ Astra Control の外部）、 Astra Control の [ アプリ ] ページに移動して、アプリの管理を開始できます。



== アプリケーション管理の要件

Astra Control アプリケーションの管理に関する次の要件を考慮してください。

* * ライセンス * ： Astra Control Center を使用してアプリケーションを管理するには、 Astra Control Center ライセンスが必要です。
* * 名前空間 * ： Astra Control では、アプリケーションが複数の名前空間にまたがることはありませんが、名前空間には複数のアプリケーションを含めることができます。
* * StorageClass* ： StorageClass が明示的に設定されたアプリケーションをインストールし、そのアプリケーションをクローニングする必要がある場合、クローン処理のターゲットクラスタに最初に指定された StorageClass が必要です。明示的に StorageClass を設定したアプリケーションを、同じストレージクラスを使用しないクラスタにクローニングすると、失敗します。
* * Kubernetes リソース * ： Astra Control で収集されない Kubernetes リソースを使用するアプリケーションには、アプリケーションデータの完全な管理機能がない可能性があります。Astra Control では、次の Kubernetes リソースが収集されます。


[cols="1,1,1"]
|===


| クラスタロール | ClusterRoleBinding | ConfigMap 


| CustomResourceDefinition の場合 | CustomResource の場合 | cronjob 


| デモンセット（ DemonSet ） | HorizontalPodAutoscaler のように表示されます | 入力 


| DeploymentConfig | MutingWebhook | PersistentVolumeClaim のように表示され 


| ポッド | PodDisruptionBudget （予算の廃止） | PodTemplate 


| ネットワークポリシー | ReplicaSet | ロール 


| RoleBinding です | ルート | 秘密 


| サービス | サービスアカウント | Stateful役立つ セット 


| 検証 Webhook |  |  
|===


=== サポートされているアプリインストール方法

次の方法を使用して、 Astra Control で管理するアプリケーションをインストールできます。

* * マニフェストファイル * ： Astra Control は、 kubectl を使用してマニフェストファイルからインストールされたアプリケーションをサポートします。例：
+
[listing]
----
kubectl apply -f myapp.yaml
----
* * Helm 3 * ： Helm を使用してアプリケーションをインストールする場合、 Astra Control には Helm バージョン 3 が必要です。Helm 3 （または Helm 2 から Helm 3 にアップグレード）を使用してインストールされたアプリケーションの管理とクローニングが完全にサポートされています。Helm 2 でインストールされたアプリケーションの管理はサポートされていません。
* * オペレータが導入したアプリケーション * ： Astra Control は、名前空間を対象とした演算子を使用してインストールされたアプリケーションをサポートします。これらの演算子は、一般に「パスバイリファレンス」アーキテクチャではなく「パスバイ値」で設計されています。これらのパターンに続くいくつかのオペレータアプリを次に示します。
+
** https://github.com/k8ssandra/cass-operator/tree/v1.7.1["Apache K8ssandra"^]
+

NOTE: k8ssandra では、インプレースリストア処理がサポートされています。新しいネームスペースまたはクラスタにリストアするには、アプリケーションの元のインスタンスを停止する必要があります。これは、ピアグループ情報がインスタンス間通信を行わないようにするためです。アプリケーションのクローニングはサポートされていません。

** https://github.com/jenkinsci/kubernetes-operator["Jenkins CI"^]
** https://github.com/percona/percona-xtradb-cluster-operator["Percona XtraDB クラスタ"^]




Astra Control では、「パスバイリファレンス」アーキテクチャ（ CockroachDB オペレータなど）で設計されたオペレータをクローニングできない場合があります。クローニング処理では、クローニング処理の一環として独自の新しいシークレットが存在する場合でも、クローニングされたオペレータがソースオペレータから Kubernetes シークレットを参照しようとします。Astra Control がソースオペレータの Kubernetes シークレットを認識しないため、クローニング処理が失敗する場合があります。


NOTE: インストールする演算子とアプリケーションは、同じ名前空間を使用する必要があります。このような名前空間を使用するには、演算子の deployment.yaml ファイルを変更する必要があります。



== クラスタにアプリをインストールします

Astra Control にクラスタを追加したので、クラスタにアプリケーションをインストールできます。新しいストレージクラスでは、永続ボリュームはデフォルトでプロビジョニングされます。ポッドがオンラインになったら、 Astra Control を使用してアプリケーションを管理できます。

Astra Control は、 Astra Control によってインストールされたストレージクラス上にストレージがある場合にのみ、ステートフルアプリケーションを管理する。

* link:../learn/choose-class-and-size.html["GKE クラスタのストレージクラスについて説明します"]
* link:../learn/azure-storage.html["AKS クラスタのストレージクラスについて学習します"]


Helm チャートから一般的なアプリケーションを展開する方法については、以下を参照してください。

* link:../solutions/mariadb-deploy-from-helm-chart.html["Helm チャートから MariaDB を導入します"]
* link:../solutions/mysql-deploy-from-helm-chart.html["Helm チャートから MySQL を導入します"]
* link:../solutions/postgres-deploy-from-helm-chart.html["Helm チャートから Postgres を導入します"]
* link:../solutions/jenkins-deploy-from-helm-chart.html["Helm チャートから Jenkins をデプロイします"]




== アプリの管理

Astra Control は、クラスタで実行されているアプリケーションを検出すると、管理方法を選択するまで管理対象外になります。Astra Control のマネージドアプリケーションには、次のいずれかを使用できます。

* ネームスペース。ネームスペース内のすべてのリソースを含みます
+
image:diagram-managed-app1.png["この概念図は、 Astra がネームスペース内のすべてのリソースを管理する仕組みを示しています。"]

* ネームスペース内に helm3 を使用して導入された個々のアプリケーション
+
image:diagram-managed-app2.png["この概念図は、他のアプリケーションを含むネームスペースに配置された個々のアプリケーションを Astra が管理する様子を示しています。"]

* ネームスペース内の Kubernetes ラベル（ Astra Control 内の _custom APP_in Astra Control と呼ばれます）で識別されるリソースのグループ
+
image:diagram-managed-app3.png["Kubernetes ラベルを基にカスタムアプリケーションを管理する Astra の概念図。"]



以下のセクションでは、これらのオプションを使用してアプリケーションを管理する方法について説明します。



=== ネームスペースでアプリケーションを管理します

アプリページの * 検出された * セクションには、名前空間と Helm によってインストールされたアプリ、またはそれらの名前空間内のカスタムラベル付きアプリが表示されます。各アプリケーションを個別に管理することも、ネームスペースレベルで管理することもできます。データ保護処理に必要な精度のレベルが重要になります。

たとえば、毎週同じ頻度で「 Maria 」のバックアップポリシーを設定したいのに、同じネームスペースにある「 MariaDB 」をバックアップする頻度を高く設定するとします。これらのニーズに基づいて、アプリケーションを個別に管理する必要があり、単一のネームスペースで管理する必要はありません。

Astra Control を使用すると、階層の両方のレベル（名前空間とその名前空間内のアプリケーション）を個別に管理できますが、いずれか一方を選択することをお勧めします。Astra Control で実行したアクションは、ネームスペースレベルとアプリケーションレベルの両方で同時に実行される場合、失敗する可能性があります。

.手順
. 「 * アプリケーション」を選択し、「 * 検出済み * 」を選択します。
. 検出されたネームスペースのリストを表示し、ネームスペースを展開してアプリケーションと関連リソースを表示します。
+
Astra Control では、 Helm アプリケーションとカスタムラベルの付いたアプリケーションが名前空間に表示されます。Helm ラベルがある場合は、タグアイコンで指定されます。

. 各アプリケーションを個別に管理するか、ネームスペースレベルで管理するかを決定します。
. 階層の適切なレベルで、 [* アクション * （ * Actions * ） ] 列のドロップダウンリストを選択し、 [ * 管理（ Manage ） ] を選択します。
. アプリを管理しない場合は、目的のアプリの [ * アクション * ] 列でドロップダウンリストを選択し、 [ * 無視 * ] を選択します。
+
たとえば、「 Jenkins 」ネームスペースですべてのアプリケーションを一緒に管理して、スナップショットポリシーとバックアップポリシーが同じになるようにする場合は、ネームスペースを管理し、ネームスペース内のアプリケーションは無視します。



管理対象として選択したアプリは、 [ 管理対象 * ] タブから利用できるようになりました。無視されたアプリは、 * 無視された * タブに移動します。新しいアプリケーションがインストールされると、検出されたタブにはアプリが表示されないため、見つけやすくなり、管理も簡単になります。



=== Kubernetes ラベルでアプリケーションを管理

Astra Control の [ アプリ ] ページの上部には、「 * カスタムアプリの定義 * 」という名前のアクションが含まれています。このアクションを使用して、 Kubernetes ラベルで識別されるアプリケーションを管理できます。 link:../learn/define-custom-app.html["Kubernetes ラベルでアプリケーションを定義する方法については、こちらをご覧ください"]。

.手順
. [ * アプリケーション（ * Applications ） ] > [ カスタムアプリケーションを定義（ Define custom app ）
. [ カスタムアプリケーションの定義 * （ Define Custom Application * ） ] ダイアログボックスで、アプリケーションを管理するために必要な情報を入力します。
+
.. * 新しいアプリ * ：アプリの表示名を入力します。
.. * クラスタ * ：アプリケーションが存在するクラスタを選択します。
.. * 名前空間 * ：アプリケーションの名前空間を選択します。
.. * ラベル * ：ラベルを入力するか、以下のリソースからラベルを選択してください。
.. * 選択したリソース * ：保護する Kubernetes リソース（ポッド、シークレット、永続ボリュームなど）を表示および管理します。
+
*** リソースを展開し、ラベル数を選択して、使用可能なラベルを表示します。
*** ラベルを 1 つ選択します。
+
ラベルを選択すると、 [*Label*] フィールドにラベルが表示されます。Astra Control は、 [ 選択されていないリソース * ] セクションも更新して、選択したラベルと一致しないリソースを表示します。



.. * 選択されていないリソース * ：保護する必要がないアプリケーションリソースを確認します。


. 「 * カスタムアプリを定義 * 」を選択します。


Astra Control を使用すると、アプリケーションを管理できます。これで、 [* 管理対象 * （ * Managed * ） ] タブに表示されます。



== システムアプリケーションについて教えてください。

Astra Control は、 Kubernetes クラスタで実行されているシステムアプリケーションも検出します。[ アプリケーション（ Apps ） ] リストをフィルタリングすることで、これらを表示できます。

image:acs_apps_system_apps3.png["アプリケーション画面ですべてのクラスタを選択した場合に使用可能なシステムアプリケーションの表示オプションを示すスクリーンショット。"]

これらのシステムアプリは、バックアップが必要になることが稀であるため、デフォルトでは表示されません。
